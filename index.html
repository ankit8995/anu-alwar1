<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Team Anu Alwar Chat</title>
<style>
  *{box-sizing:border-box}
  :root{
    --bg:#0f172a;
    --card:#1e293b;
    --accent:#0ea5e9;
    --accent2:#22c55e;
    --danger:#ef4444;
    --text:#ffffff;
    --muted:#94a3b8;
  }
  body{
    margin:0; background:var(--bg); color:var(--text);
    min-height:100vh; display:flex; align-items:center; justify-content:center;
    font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  }

  /* ---------- Auth / Form Screen ---------- */
  #login-screen{
    width:min(92vw,420px);
    background:var(--card);
    border-radius:24px;
    padding:28px 22px;
    box-shadow: 0 30px 80px rgba(0,0,0,.35);
    animation:fadeIn .6s ease;
    text-align:center;
  }
  .yt-badge{
    width:86px; height:86px; margin:6px auto 10px; border-radius:20px;
    background: radial-gradient(120px 120px at 30% 30%, #ff6b6b, #ff3434 60%),
                linear-gradient(135deg, #ff2d2d, #ff7a3d);
    display:grid; place-items:center; position:relative; overflow:hidden;
    box-shadow: 0 10px 30px rgba(255,52,52,.35), inset 0 -10px 20px rgba(0,0,0,.25);
  }
  .yt-badge:before{
    content:"â–¶";
    font-size:46px; color:#fff; transform:translateX(4px);
    filter:drop-shadow(0 4px 8px rgba(0,0,0,.25));
    animation:ytPulse 2s ease-in-out infinite;
  }
  @keyframes ytPulse{
    0%,100%{transform:translateX(4px) scale(1)}
    50%{transform:translateX(4px) scale(1.12)}
  }
  h1{font-size:1.6rem;margin:6px 0 14px;letter-spacing:.3px}
  .sub{color:var(--muted);font-size:.95rem;margin-bottom:18px}
  .form{
    display:grid; gap:12px; text-align:left; margin:10px 0 6px;
  }
  .input{
    background:#0b1220;border:1px solid #192133;color:#fff;
    padding:14px 14px;border-radius:14px; outline:none; font-size:1rem;
    transition: border .2s ease, box-shadow .2s ease;
  }
  .input:focus{border-color:var(--accent); box-shadow:0 0 0 4px rgba(14,165,233,.15)}
  .btn{
    background:linear-gradient(135deg, var(--accent), #6ad7ff);
    color:#002232; border:0; padding:14px 16px; font-weight:700;
    border-radius:14px; cursor:pointer; margin-top:6px; letter-spacing:.3px;
    box-shadow:0 10px 24px rgba(14,165,233,.35); transition:transform .08s ease;
  }
  .btn:active{transform:translateY(1px)}

  /* ---------- Popup ---------- */
  #popup{
    position:fixed; inset:0; display:none; place-items:center; z-index:50;
    background:rgba(0,0,0,.55); backdrop-filter: blur(2px);
  }
  .pop-card{
    width:min(90vw,420px); background:#111827; color:#fff; border-radius:20px;
    padding:22px; text-align:center; box-shadow: 0 24px 64px rgba(0,0,0,.5);
    animation:pop .35s ease;
  }
  @keyframes pop{from{transform:scale(.82);opacity:0} to{transform:scale(1);opacity:1}}
  .sticker{
    font-size:64px; line-height:1; display:inline-block; margin-bottom:8px;
    animation:floaty 2s ease-in-out infinite;
  }
  @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
  .pop-title{font-weight:800; font-size:1.25rem; margin:6px 0 4px}
  .pop-sub{color:#cbd5e1; font-size:.95rem}

  /* ---------- Confetti Canvas ---------- */
  #confetti{
    position:fixed; inset:0; pointer-events:none; z-index:60; display:none;
  }

  /* ---------- Chat Screen ---------- */
  #chat-screen{
    display:none; flex-direction:column;
    width:min(100vw,480px); height:92vh; background:var(--card);
    border-radius:26px; overflow:hidden; box-shadow:0 30px 80px rgba(0,0,0,.45);
    animation:slideUp .5s ease;
  }
  @keyframes slideUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}

  #chat-header{
    background:linear-gradient(135deg, var(--accent), #7cd3ff);
    color:#002232; padding:14px 16px; display:flex; align-items:center; justify-content:space-between;
    font-weight:800; letter-spacing:.3px;
  }
  .badge{
    background:#00223215; color:#002232; border:1px solid #00223240;
    padding:6px 10px; border-radius:999px; font-size:.8rem; font-weight:700;
  }

  #messages{
    flex:1; padding:16px 12px 10px; overflow:auto; display:flex; flex-direction:column; gap:10px;
    background:
      radial-gradient(1200px 500px at 50% 0%, #0b1328 0%, transparent 65%),
      radial-gradient(600px 300px at 10% 40%, #0a2131 0%, transparent 60%),
      radial-gradient(600px 300px at 90% 60%, #0a1b2a 0%, transparent 60%),
      #0b1220;
  }

  .msg{
    max-width:76%; padding:10px 14px; border-radius:14px; font-size:.98rem;
    position:relative; animation:msgIn .22s ease;
    box-shadow: 0 8px 18px rgba(0,0,0,.22);
  }
  @keyframes msgIn{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
  .from-other{ align-self:flex-start; background:#172033; border:1px solid #2a3a57;}
  .from-me{ align-self:flex-end; background:#0b5bd5; border:1px solid #1d74ff;}
  .meta{font-size:.72rem;color:#cbd5e1;opacity:.85;margin-bottom:4px}
  .from-other .meta{color:#a8c5ff}
  .from-me .meta{color:#d6e8ff}

  #chat-input{
    background:#0b1220; padding:10px; display:flex; gap:10px; align-items:center; border-top:1px solid #0f1a2e;
  }
  #text{
    flex:1; background:#0a152a; color:#fff; border:1px solid #18233a; padding:12px 14px;
    border-radius:14px; outline:none; font-size:1rem;
  }
  #send{
    background:linear-gradient(135deg, var(--accent2), #8df2b0); color:#032413;
    border:0; padding:12px 16px; border-radius:14px; font-weight:800; cursor:pointer;
    box-shadow:0 10px 24px rgba(34,197,94,.3);
  }
  .hint{
    text-align:center; color:#94a3b8; font-size:.9rem; padding:8px 0 2px;
  }

  @media (max-width:520px){
    #chat-screen{height:96vh; border-radius:0}
  }
</style>
</head>
<body>

  <!-- Confetti Canvas -->
  <canvas id="confetti"></canvas>

  <!-- Login / Form Screen -->
  <section id="login-screen">
    <div class="yt-badge" aria-hidden="true"></div>
    <h1>Join Anu Alwar Team</h1>
    <p class="sub">Enter your name & Room ID to join the group</p>

    <div class="form">
      <label style="color:#cbd5e1;font-weight:600">Your Name</label>
      <input class="input" id="name" placeholder="Enter your name" />

      <label style="color:#cbd5e1;font-weight:600">Room ID</label>
      <input class="input" id="room" placeholder="Enter Room ID" />
    </div>

    <button class="btn" id="joinBtn">Join</button>
  </section>

  <!-- Popup -->
  <div id="popup">
    <div class="pop-card">
      <div class="sticker" id="popSticker">ðŸ«¶</div>
      <div class="pop-title" id="popTitle">Welcome!</div>
      <div class="pop-sub" id="popSub">Glad to have you here.</div>
    </div>
  </div>

  <!-- Chat Screen -->
  <section id="chat-screen" role="main" aria-label="Chat">
    <header id="chat-header">
      <div id="roomTitle">Room: anu alwar</div>
      <div class="badge" id="onlineBadge">Online: 1</div>
    </header>

    <div id="messages"></div>
    <div class="hint" id="hint"></div>

    <footer id="chat-input">
      <input id="text" placeholder="Type a messageâ€¦" />
      <button id="send">Send</button>
    </footer>
  </section>

<script>
/* ------------------ Utils ------------------ */
const ROOM_KEY = "room:anu alwar";
const correctRoom = "anu alwar";

const $ = sel => document.querySelector(sel);
const on = (el, ev, fn) => el.addEventListener(ev, fn);

/* Presence in localStorage (multi-tab demo) */
function getMembers(){
  try{ return JSON.parse(localStorage.getItem(ROOM_KEY)) || [] } catch{ return [] }
}
function setMembers(arr){
  localStorage.setItem(ROOM_KEY, JSON.stringify(arr));
  // trigger storage for same tab logic
  window.dispatchEvent(new StorageEvent("storage", {key:ROOM_KEY, newValue:JSON.stringify(arr)}));
}
function joinPresence(name){
  const set = new Set(getMembers());
  set.add(name);
  setMembers([...set]);
}
function leavePresence(name){
  const set = new Set(getMembers());
  set.delete(name);
  setMembers([...set]);
}

/* ------------------ Confetti ------------------ */
const confettiCanvas = $("#confetti");
const ctx = confettiCanvas.getContext("2d");
let confettiPieces = [];
function sizeCanvas(){
  confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight;
}
function makeConfetti(n=180){
  confettiPieces = Array.from({length:n}).map(()=>({
    x: Math.random()*confettiCanvas.width,
    y: -20 - Math.random()*confettiCanvas.height*0.5,
    r: 3+Math.random()*5,
    c: `hsl(${Math.random()*360},100%,60%)`,
    s: 1+Math.random()*3,
    a: Math.random()*Math.PI*2
  }));
}
function drawConfetti(){
  ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
  confettiPieces.forEach(p=>{
    p.y += p.s;
    p.x += Math.sin(p.a+=0.02);
    ctx.beginPath(); ctx.fillStyle=p.c;
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
  });
}
let confettiRAF;
function runConfetti(ms=1500){
  sizeCanvas(); confettiCanvas.style.display="block";
  makeConfetti();
  const start = performance.now();
  function loop(t){
    drawConfetti();
    if(t-start < ms){ confettiRAF = requestAnimationFrame(loop) }
    else { confettiCanvas.style.display="none"; cancelAnimationFrame(confettiRAF); }
  }
  confettiRAF = requestAnimationFrame(loop);
}
window.addEventListener('resize', sizeCanvas);

/* ------------------ Popup Helpers ------------------ */
function showPopup(sticker, title, sub, ms=1600){
  $("#popSticker").textContent = sticker;
  $("#popTitle").textContent = title;
  $("#popSub").textContent = sub;
  $("#popup").style.display = "grid";
  setTimeout(()=> $("#popup").style.display = "none", ms);
}

/* ------------------ App State ------------------ */
let me = {name:"", joined:false};

function updateOnlineBadge(){
  const members = getMembers();
  $("#onlineBadge").textContent = `Online: ${members.length}`;
}

function maybeShowIdleHint(){
  const members = getMembers();
  const hint = $("#hint");
  if(members.length <= 1){
    hint.textContent = "Bhai koi bhi nhi he sab log busy he tu bhi kam kr le apan jb sab aa jaye tab baat kar lena ðŸ˜…";
  }else{
    hint.textContent = "";
  }
}

/* ------------------ Chat Rendering ------------------ */
const messages = $("#messages");
function addMsg({from, text, side}){
  const wrap = document.createElement("div");
  wrap.className = "msg " + (side === "me" ? "from-me" : "from-other");
  const meta = document.createElement("div");
  meta.className = "meta";
  meta.textContent = side === "me" ? me.name : from;
  const body = document.createElement("div");
  body.textContent = text;
  wrap.append(meta, body);
  messages.appendChild(wrap);
  messages.scrollTop = messages.scrollHeight;
}

/* ------------------ Handlers ------------------ */
on($("#joinBtn"), "click", () => {
  const name = $("#name").value.trim();
  const room = $("#room").value.trim().toLowerCase();

  if(!name || !room){
    showPopup("ðŸ¤","Name & Room ID required","Dono fields fill karo bhai.",1300);
    return;
  }
  if(room !== correctRoom){
    showPopup("ðŸ˜œ","Q bhai team join nhi krni","Sahi Room ID: 'anu alwar' dal ke aa jao!",1700);
    return;
  }

  // Welcome + confetti then enter chat
  showPopup("ðŸŽ‰","Welcome!","Team Anu Alwar me swagat hai!",1200);
  runConfetti(1500);

  setTimeout(()=>{
    me.name = name; me.joined = true;
    $("#login-screen").style.display = "none";
    $("#chat-screen").style.display = "flex";
    $("#roomTitle").textContent = "Room: " + correctRoom;

    joinPresence(me.name);
    updateOnlineBadge();
    maybeShowIdleHint();

    // If you're alone, add a one-time system hint as a message style (optional)
    if(getMembers().length <= 1){
      addMsg({from:"Anu Alwar", text:"(Team abhi join ho rahi haiâ€¦ thoda kaam nipta lo ðŸ˜Š)", side:"other"});
    }
  }, 1250);
});

on($("#send"), "click", () => {
  if(!me.joined) return;

  const text = $("#text").value.trim();
  if(!text) return;

  // Only allow chat for members of the room (we already joinedPresence)
  addMsg({from:me.name, text, side:"me"});
  $("#text").value = "";

  // If alone, do NOT auto-reply (as per requirement). Just keep hint.
  if(getMembers().length > 1){
    // Example: simulate someone else (left side). In real app, this comes from server.
    setTimeout(()=> addMsg({from:"Anu Alwar", text:"ðŸ‘ Seen!", side:"other"}), 700);
  }
});

on($("#text"), "keydown", (e)=>{
  if(e.key==="Enter"){ $("#send").click(); }
});

/* Respond to other tabs joining/leaving */
window.addEventListener("storage", (ev)=>{
  if(ev.key === ROOM_KEY){
    updateOnlineBadge();
    maybeShowIdleHint();
  }
});

/* Remove presence on close */
window.addEventListener("beforeunload", ()=>{
  if(me.joined){ leavePresence(me.name); }
});
</script>
</body>
</html>
